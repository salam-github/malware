Ransomware Project
==================

Table of Contents
-----------------

1.  [Introduction](#introduction)
2.  [What is Ransomware?](#what-is-ransomware)
    -   [How Ransomware Works](#how-ransomware-works)
    -   [Impacts of Ransomware](#impacts-of-ransomware)
3.  [How the Program Works](#how-the-program-works)
4.  [Bypassing Anti-Viruses](#bypassing-anti-viruses)
5.  [Detailed Explanation](#detailed-explanation)
    -   [Encryption](#encryption)
    -   [Code Generation](#code-generation)
    -   [Key Generation](#key-generation)
    -   [Decryption](#decryption)
6.  [How to Use the Program](#how-to-use-the-program)
7.  [Conclusion](#conclusion)

Introduction
------------

This project involves the creation of a ransomware program designed to encrypt files on a target system and demand a ransom for their decryption. The purpose of this project is to understand the inner workings of ransomware by simulating its behavior in a controlled environment. The program has been tested to bypass many anti-virus programs, achieving a score of 3/74 on VirusTotal.

### VirusTotal Analysis

You can view the VirusTotal score/analysis of the ransomware program [here](https://www.virustotal.com/gui/file/2d0a2951923ee54b29dc681b0fff241ccf2d4345afd729de791c82f74131b6f7/detection).

### Project Audit Video

Watch the video of the project audit [here](https://youtu.be/Fl-CaBK_cXY).

What is Ransomware?
-------------------

Ransomware is a type of malicious software that encrypts the victim's files and demands a ransom payment to restore access to the data. It typically spreads through phishing emails, malicious downloads, or exploiting vulnerabilities in software. Once a system is infected, the ransomware encrypts the files and displays a ransom note with instructions on how to pay the ransom to receive the decryption key.

### How Ransomware Works

1.  **Infection**: The ransomware infects the system through malicious links, attachments, or software vulnerabilities.
2.  **Encryption**: Once activated, the ransomware scans the system for files to encrypt and uses strong encryption algorithms to lock the files.
3.  **Ransom Note**: A ransom note is displayed, instructing the victim on how to pay the ransom to receive the decryption key.
4.  **Payment**: Victims are typically asked to pay the ransom in cryptocurrencies to maintain the anonymity of the attackers.
5.  **Decryption**: After payment, the attackers may provide the decryption key to unlock the files, although this is not guaranteed.

### Impacts of Ransomware

1.  **Data Loss**: Encrypted files are inaccessible without the decryption key, leading to potential loss of critical data.
2.  **Financial Loss**: Paying the ransom can be costly, and there is no guarantee that the decryption key will be provided.
3.  **Operational Disruption**: Encrypted files can disrupt business operations, leading to downtime and productivity loss.
4.  **Reputation Damage**: Companies may suffer reputational damage if sensitive data is compromised or if they are perceived as vulnerable to cyberattacks.
5.  **Legal and Regulatory Consequences**: Organizations may face legal and regulatory consequences if they fail to protect sensitive data adequately.

How the Program Works
---------------------

The ransomware program consists of two main components:

1.  **Encryption Program**: Encrypts the files on the target system.
2.  **Decryption Program**: Decrypts the files if the correct decryption key is provided.

The encryption program performs the following steps:

1.  Delays execution using a custom sleep function to avoid detection.
2.  Encrypts target files in specified directories.
3.  Creates a ransom note with a decryption code.
4.  Adds persistence by creating a scheduled task.
5.  Changes the desktop wallpaper.
6.  Attempts to disable Windows Defender.
7.  Packages the decryption script into an executable.

The decryption program takes a decryption key provided by the user and decrypts the encrypted files.

Bypassing Anti-Viruses
----------------------

The program employs several techniques to bypass anti-virus detection:

1.  **Custom Sleep Function**: Avoids using standard sleep functions that are easily detected by anti-virus programs.
2.  **Incrementation Loop**: Includes a simple process loop for obfuscation.
3.  **Dynamic Key Generation**: Uses a combination of encryption and hashing to generate unique keys.
4.  **Obfuscation**: Utilizes various obfuscation techniques, such as renaming variables and adding dummy data, to make the code harder to analyze.

Detailed Explanation
--------------------

### Encryption

The encryption process involves the following steps:

1.  **Key Generation**:

    -   A random key is generated using the `Fernet` module from the `cryptography` library.
    -   The key is used to encrypt the files.
2.  **File Encryption**:

    -   Target files are read and encrypted using the generated key.
    -   The encrypted files are saved with a custom file extension specified in the configuration.
3.  **Ransom Note Creation**:

    -   A ransom note is created on the desktop with a unique decryption code and instructions for the user.

### Code Generation

The code for the decryption program is dynamically generated during the encryption process. This ensures that each instance of the ransomware produces a unique decryption program.

### Key Generation

The key generation process involves the following steps:

1.  **Decryption Code Generation**:

    -   A decryption code is generated by hashing the encryption key and taking a substring of the hash.
2.  **Custom Key Generation**:

    -   The decryption code is hashed again, and the result is base64 encoded to produce the final decryption key.

### Decryption

The decryption process involves the following steps:

1.  **User Input**:

    -   The user is prompted to enter the decryption key.
2.  **File Decryption**:

    -   The decryption key is used to decrypt the encrypted files.
    -   The files are renamed back to their original names.

How to Use the Program
----------------------

### Prerequisites

-   Python 3.x
-   Required Python libraries: `cryptography`, `pyinstaller`

### Steps

1.  **Configuration**:

    -   Edit the `config.py` file to specify the settings for the ransomware, such as target paths, file extensions, and executable names.
2.  **Packaging**:

    -   Run the `package_script.py` script to package the encryption program into an executable.

```python
        python package_script.py
```

3.  **Execution**:

    -   Run the generated encryption executable on the target system. This will encrypt the files and create a decryption executable on the desktop.
4.  **Decryption**:

    -   To decrypt the files, run the decryption executable and enter the correct decryption key generated by the key generation script.

### Key Generation Script

The `generate_key.py` script is used to generate the decryption key based on the decryption code provided in the ransom note. In real-world scenarios, the decryption key would be provided by the attackers upon payment of the ransom. and the victim would not have access to the key generation script.
also, the decryption key is generated using the decryption code provided in the ransom note.

```python

import hashlib
import base64

def generate_key(decryption_code):
    intermediate = hashlib.sha256(decryption_code.encode()).digest()
    key = base64.urlsafe_b64encode(intermediate[:32])
    return key

if __name__ == "__main__":
    decryption_code = input("Enter the decryption code: ")
    decryption_key = generate_key(decryption_code)
    print(f"Decryption Key: {decryption_key.decode()}")
```

Conclusion
----------

This project demonstrates the creation and operation of a ransomware program. It provides insight into how ransomware encrypts files, generates decryption keys, and bypasses anti-virus detection. This knowledge is crucial for understanding and defending against ransomware attacks in a real-world scenario.