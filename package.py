import os
import subprocess

def package_script(script_name):
    # Check if PyInstaller is installed
    try:
        import PyInstaller
    except ImportError:
        print("PyInstaller is not installed. Installing it now...")
        subprocess.check_call(['pip', 'install', 'pyinstaller'])

    # Create the command to package the script
    command = f'pyinstaller --onefile {script_name}'

    # Run the command
    process = subprocess.Popen(command, shell=True)
    process.communicate()

    # Check if the executable was created successfully
    dist_dir = 'dist'
    if os.path.exists(dist_dir):
        executable_name = script_name.replace('.py', '.exe')
        os.rename(os.path.join(dist_dir, executable_name), executable_name)
        print(f"Executable created: {executable_name}")
    else:
        print("Error: dist directory not found")

if __name__ == "__main__":
    script_to_package = 'encrypt_desktop_files.py'
    package_script(script_to_package)
    input("Press Enter to exit...")  # Keep the console window open

